SELECT 
    CASE 
        WHEN CHARINDEX('?', url) > 0 THEN LEFT(url, CHARINDEX('?', url) - 1)
        WHEN CHARINDEX('/[0-9]', url) > 0 THEN LEFT(url, CHARINDEX('/[0-9]', url) - 1)
        ELSE url
    END AS grouped_url,
    COUNT(*) AS url_count
FROM your_table
GROUP BY 
    CASE 
        WHEN CHARINDEX('?', url) > 0 THEN LEFT(url, CHARINDEX('?', url) - 1)
        WHEN CHARINDEX('/[0-9]', url) > 0 THEN LEFT(url, CHARINDEX('/[0-9]', url) - 1)
        ELSE url
    END;
